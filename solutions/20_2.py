input_ = """.#.....#............#...#.##.#..#.#..............#....#.....#...#.#......#......#.......####..#.
.#.#..#............##..............#.#......##.##....#........#...#.#.##......................#.
.......###..#..##....#..#..#...#....#................###...#..#......#......#.....#.........##.#
....#..#..#........#.............#........##......#...###....#..#.#.......................#.....
.....#.....#.#...#........#.#.....#....#.....#.#....#......#.................#....#...##.#.....#
....#.........#.....#..#.#..#............#..#........#...#.......##......#.#..#.#..#....#.......
#..#....##...................#......#..........#.#...#....#...............##.#.##...#..#........
.........#.##.#.##....#.........#..........#......##..#.##..#.#....#.#...#.##.........#...#.##..
....#.#...........#...........##..#.......#..........#.#..#..##..........#.#....#....#...##.#.#.
#...##.....#......#..........#....#.....#.##.###....##......#..#.........#........##.#.#.####..#
..##.#.#..#.......##.....##..#......#.#..#.........###.....#........#........#...##.##..#.#....#
....#....#.....###...##......##.........#.#..#..##.....#.....#..#..#..#...#.........#...###.....
...#..#....#..........###...#......#...#.....#..#..#.#.##.#.#.#.....###.#......#.##....#....#..#
....#..#.......##.#.....#..........#.....#........#.....#...#..#.......#......#.#.##.........#..
#...##.#......#.###...#.#.##.....##.#..##..#....#####.##..##.#....###..............##.......##..
.....#...#.#......#...#........#...#..#..##.#..##.............##....#....##..#.....##..#........
##...#....#.......#......#.##.#.......#..#.......##.#..###...#.#....#..##.#..#....#.....#......#
....#..###.#.##..#....#....##..#..#.....#..##..#.#.....#.#........##..#.#..#.......#....#...#...
#.#..#......#.#.........#..#.#.......###.#..#...#.#.....#...........#...#.#......##...##...#...#
..#..#.......#..##.....###...#..#.#..###.#..#.....#.....#....#........###.........#...........##
...##....#.......#......#..#........#...##..#....#....###.....#.######...#..#......#............
#....##...##...#..#####...#.#....#.....###.#....#.#........#.###....#....##...#....#...##.....#.
.#...###..#.......#.....#.#.#....#.......#....##.#......#..#.##.....#...####..#.###.....#.#..##.
.....#.#.#..#...##..##....#####.....##..#........#....##....#......#.#..#......##....#.###.#..#.
#..#...#..#.....#....#.......##.#..#..#.#.....####.#.##.#....#............#.........##..#.#.....
.....#..#....#......##..#.#..#....#............#........##...#..####....#..#....#.##.#.....#....
........##..#..####...#....#............#.#.#...#..#...##.....#....#.....#....#.#..#........#.#.
....#.....#.##....#.##.....##..#.........#.#....#......#..#...#.....#....#..#.#....##..##....##.
......##..#..#.#..##....##.###..#.#.##.#.##...#..##..........#......#####......##.##......#..#..
###..#..###.......#........#.......#....##.......##....##.#....##...#.#..........##.#...#..##...
................#...#.##.......#...###........#..##...#.#.#.....#...#.#.###.........#...#.......
.#...#.#.....#.#......#......#....#..##.#.#......#.........#.#.#.....#..#...###.........#..#....
##.##....##....#...........#....##.....#............#...#..#..##....#...###.......#...#.....#...
.#...#..#.##.......##..##...#...#.#..#.#..#..#........##.#....##.......#.##....#...#.##......##.
..#.....#.##.#......##......##..#.#..##.........#..#..#..#...##..#.....#.#..........#........#..
.#.#.###..#.#.#..#...#...#..#......##.....#.#...##.....##.....##....#.##.......##.......#...##.#
##..............#...#..#...........#####.###.#....###.##........#.......#..#...........#...#...#
.....#...#..#......##.#.......##..#.##.......#..##.......##..#........#..#...#.##.#.......#.#..#
..............#...#.#.......#......#.#......#..##..........#......#.....#...#......#.....#..#..#
#.....#.....#..#...#.#...#..##....#.#.#......................#.#..#..........#.....#...#.#..###.
........##..#.....#...#...##......#.....##......####.#..##......#.#....#..#.......#.....###..##.
..#..####..##..#.......#.##........#.#......#.....##..................##.#..##.#.....##.#...#...
...#.#.##.#....#.#..#..#.##.#......##...#...##....#...##..#........#..#####.##..#..#......#....#
...#.....#....##......#....#...##..#.#...#...##..###...#...#......#....##....#..........##.##...
.#........#..#.........##.#..#..####....#..##...#.........#..............#.##...#..##.#.##..#...
......#.###...#......#.......#.#.#............#..#.#....#..........#....#....#...#.#.....#...#..
#.........#.....#..####....##...............##.###...#....###..#...###......#....##..#...#...##.
#.........#..#.#..##...#.#..#....##...###...###...#.#...#.#...#..#..#....#..##..........#..#.#.#
...#.##...............###...#..#.#.......###.#....#........#..#.#...#.#..#...#...#....#....#....
...#.#..#......#.#...####...#........##..#..##...#.........#.#..#...#....#...#..#.#......#......
..#............#......#..#...#.##...#...##.##.........#...#.#....#......#..##.#.#.....#.#..#.#.#
#.####....#..###....##.......#...#.....#.......###...#.........#....#....#...#..##..#..#.#.....#
...#.#..#....#...#....#.##..#....#........#.#...##....#....##..#......##..#.#.#....#....####.#..
.....##.##...#..#..#...#....#.....##.#..#..###.####.......#....##.#.#.#.....##..#..##...##.....#
......#.#..#.#.........##.......##..#....#...#..#.###......#...#..#..#..#....#.#................
.....#...##.#......#.#.##...#..#..#....#.##..##..##.##...#.#.......#..#...#..##..#.#.#.....#...#
.##........#.#.....#..#.##...#.#.#......#....#....#.#..#..##.#.#.........#.#.##.###.....#...#..#
...........##.#.#.#.........##...#........#...##..........##..#...#......#........##.....#.#....
.....#....##...#............##...##..###.......#...#..#.................##.....#...#.#.#.##.....
#.##..#....#....#.......##.......##.....#........#.#......#.....#..#.#...#...#.##.#.#.####.#.##.
.#....##...#..#..................#..##.#.#####...#....#.#..##..#........#..#..#.#####.#.#....#..
.#...#....#....#....#.......##......#.#..##..#..........#..##.#.###......#...#..##.....##.......
.#..........#...#........#..###......#...#.........#.#.#.#.#....##.#.....#.#........##........##
....#.........#.#............##..#.##.........#.....#....##.#...#.....#..##......#...##........#
#....#..#.#...##....#.....#..#.####...#......##.#....#...#.......#....#...#...#.##.#.#..###.....
##....#....#.#......###........#..#.#......#.#.....#..#.....#...#......#......#.....#.#..#.....#
....#.##...#....###.##..#....##.##.#..##.#........#....#........#...#..#.####....#.#..#......#.#
....#.#.#.#...##.#...#.#..##.....#....#....###........#......#..##......##.##.##.##..#.#.#...#..
.....###.#.##...#.##.##...#....#..............#............#.....#.........#.#......#...##......
...##.......#...#..##.......#....#..#...#.#..##....#.#...#.....###........#..#.#..#..#....#...#.
...##.....#..#.#.#....#..###......#...#....#.#..#...#.#...#..#.#.#..#.#....#.#.##..#.#....#....#
....###.#..#...........#..#......####..#..#.#..........##....................#.#....#....#.#....
...#.......##......#..#....###....#..#.#............##.#...#....#........##.#....#...#...#..#.##
..#.......##...#...........##.#......##.....##.#..##..#...#......#....#..###.#......#....##....#
...........##..##.#.#.##..#.#....#.#####..#...#......##.....#.##.##.####.#.#........#..#.##..#..
..##....#...##..##...##.##.......#.....#......#..##.#......#...####.....#.##.#.#.....##...#.....
..#.#...........#...#.##...........#..#...#..#...##...###..#..#.....#.....#.##....#..##.###..#..
...###..#...#..#..##......#..#..#..#...#.#...#.........#.#..##.....###.....#.#.......#...#.#.#..
...###.......#..#..#.##....#....##..#..#..##...#......##.#.#.##.#.....#...#..##....#............
..#......##..........#.#...#...#.#..#.#......#.#......##...##..#.##...#.#..#...#.......##...#...
..#..#...#...##........##.#........#.#.##.#...##........#...###..##..##....##..#.....#...##....#
..####...........##...#.#...##.#....#....#..#.##....#.#..#.......#.....#.###..#...........#.#...
.#..#.#......#.......#........#......##..#....#..#..#.#........##..#..#.....##.#...#.#....##....
.#.##.....#......#........#..#.#.......#.###.....#.....#.............##.....#.#...........#.....
#..#.##.#......##.##.##.#..#...#.##...###..#.#....#....##....#...#..#.#...........#.....#....#..
....##..#....##....#...#..####.....##..#............#.##.#............#.#..##....#.....##..#.#..
#.#...#..#...#.#.......#...#...#.......................#......##..#..##....#..##..#...#...#.....
..##...#......#.#.....#.###........................#.............###......#..#.......#.......#..
....#..###...#.......#....#...#....#.#...#.....................##...##.#.#.#...#.........###....
######........#.......#..#..........#..#....#....#....##....#.......###..##.....#...#...#....#..
#..##...#.#......#....#..#...#.#............#..#...............#...#..#.....##..#........#....#.
.....#..####......####.#.##..#...##..#.................#.#....#.....#.##....#.#.....#........#..
....#.#.............#..##.#.#...#.#....##.........#......#....#.#.#...#.............#...........
.#.##...............#.##.##...................#.........#..#....#..##....#..#...#...##.#.#..##..
#..#.....##..#...#.#....#.##....#.....#..#......#..#.#...........#...#.#.....##..#.........#....
....#.#..#...##....#...#..............#.......#..#....#.......#.##.#.....##.#...#...#..#.#...#.."""

# input_ = """.#.#..#.##...#.##..#####
# ###....#.#....#..#......
# ##.##.###.#.#..######...
# ###.#####...#.#####.#..#
# ##.#....#.##.####...#.##
# ...########.#....#####.#
# ....#..#...##..#.#.###..
# .####...#..#.....#......
# #..#.##..#..###.#.##....
# #.####..#.####.#.#.###..
# ###.#.#...#.######.#..##
# #.####....##..########.#
# ##..##.#...#...#.#.#.#..
# ...#..#..#.#.##..###.###
# .#.#....#.##.#...###.##.
# ###.#...#..#.##.######..
# .#.#.###.##.##.#..#.##..
# .####.###.#...###.#..#.#
# ..#.#..#..#.#.#.####.###
# #..####...#.#.#.###.###.
# #####..#####...###....##
# #.##..#..#...#..####...#
# .#.###..##..##..####.##.
# ...###...##...#...#..###"""

# input_ = """.####...#####..#...###..
# #####..#..#.#.####..#.#.
# .#.#...#.###...#.##.##..
# #.#.##.###.#.##.##.#####
# ..##.###.####..#.####.##
# ...#.#..##.##...#..#..##
# #.##.#..#.#..#..##.#.#..
# .###.##.....#...###.#...
# #.####.#.#....##.#..#.#.
# ##...#..#....#..#...####
# ..#.##...###..#.#####..#
# ....#.##.#.#####....#...
# ..##.##.###.....#.##..#.
# #...#...###..####....##.
# .#.##...#.##.#.#.###...#
# #.###.#..####...##..#...
# #.###...#.##...#.######.
# .###.###.#######..#####.
# ..##.#..#..#.#######.###
# #.#..##.########..#..##.
# #.#####..#.#...##..#....
# #....##..#.#########..##
# #...#.....#..##...###.##
# #..###....##.#...##.##.#"""

monster_input = "                  # \n" + \
                "#    ##    ##    ###\n" + \
                " #  #  #  #  #  #   "

monster = [[c == '#' for c in row] for row in monster_input.splitlines()]
from copy import deepcopy

def printImage(img):
    for row in img:
        for c in row:
            if c == True:
                print('#',end='')
            elif c == False:
                print('.',end='')
            else:
                print(c,end='')
        print('')
    print('')

def solve_2(image):

    def isMonster(img,x,y):
        monster_size_y = len(monster)
        monster_size_x = len(monster[0])
        for off_y in range(monster_size_y):
            for off_x in range(monster_size_x):
                if y+off_y >= Y or x+off_x >= X or (monster[off_y][off_x] and not img[y+off_y][x+off_x]):
                    return False
        return True

    def revealMonster(img, y, x):
        monster_size_y = len(monster)
        monster_size_x = len(monster[0])
        for off_y in range(monster_size_y):
            for off_x in range(monster_size_x):
                if monster[off_y][off_x]:
                    img[y+off_y][x+off_x] = 'O'

    def flip(img):
        new_pic = deepcopy(img)
        n = len(img)
        for i,row in enumerate(img):
            for j,_ in enumerate(row):
                new_pic[i][j] = img[n-i-1][j]
        return new_pic

    def rotate(img):
        new_pic = deepcopy(img)
        n = len(img)
        for i,row in enumerate(img):
            for j,_ in enumerate(row):
                new_pic[i][j] = img[n-j-1][i]
        return new_pic

    def countPixels(img):
        c = 0
        for row in img:
            for e in row:
                if e == True:
                    c += 1
        return c

    def foundMonster(img):
        found = False
        for i in range(Y):
            for j in range(X):
                if isMonster(img,j,i):
                    found = True
                    revealMonster(img, i, j)
        return found

    Y = len(image)
    X = len(image[0])

    new_img = deepcopy(image)

    found = None
    for i in range(4):
        new_img = rotate(new_img)
        if foundMonster(new_img):
            found = new_img
            break

    if not found:
        new_img = flip(new_img)
        for i in range(4):
            new_img = rotate(new_img)
            if foundMonster(new_img):
                found = new_img
                break

    if not found:
        return None

    printImage(found)
    return countPixels(new_img)

image = [[c == '#' for c in row] for row in input_.splitlines()]

print("Part #2:", solve_2(image))
